# 定性結果・不等号の表現
更新日: 2016/02/12

## 変換の趣旨
JAHIS臨床検査データ交換規約Ver.3.1では、

>『数値型の検査結果であっても比較演算子や接尾辞を持つ場合、値型が文字列STの場合と構造化数値SNの場合によって、検査結果値の表記が異なるので注意、例えば、ST型では100以上( >100 )や 2+であるが、SN型では >^100 や ^2^+ となる。可能な限りSN型を使用することを推奨する。』

としている。ここではSN型の表記例を挙げる。ただし、SS-MIX2 ver.1.2cではOBX-5(結果値）にSN型を許可していないため、本事業では『^』を半角スペースで置き換えST型で記載する。

## 正規表現について

Extended Regular Expressionで記載する。前後のスペースを除去したものに適用させることを想定している。
[regexper.com](http://regexper.com/) 等で視覚的に確認することが出来る。

## パターンファイル
[convert_to_sn.ptn](../master/convert_to_sn.ptn)

## 数値について
HL7 ver.2.5のNM型から正の記号を除いたものを【数値】とする。適宜読み替えること。

#### 【数値】の正規表現:

    \-?[0-9]+\.?[0-9]*|\-?\.[0-9]+

## 1.検出限界超の値

#### SN型での記載:

    >^【数値】

#### 正規表現:

    ^【数値】 ?(<|＜)$
    ^(>|＞) ?【数値】$

#### 変換前の例:

    100<
    100 <
    100＜
    100 ＜
    >100
    > 100
    ＞100
    ＞ 100

## 2.検出限界以上の値

#### SN型での記載:

    >=^【数値】

#### 正規表現:

    ^【数値】 ?(≦|<=|=<|＜＝|＝＜)$
    ^【数値】 ?以上$
    ^(≧|>=|=>|＞＝|＝＞) ?【数値】$
    
#### 変換前の例:

    200≦
    200 ≦
    200<=
    200 <=
    200=<
    200 =<
    200＜＝
    200 ＜＝
    200＝＜
    200 ＝＜
    200以上
    200 以上
    ≧200
    ≧ 200
    >=200
    >= 200
    =>200
    => 200
    ＞＝200
    ＞＝ 200
    ＝＞200
    ＝＞ 200
 
## 3.検出限界未満の値

#### SN型での記載:

    <^【数値】
    
#### 正規表現:

    ^【数値】 ?(>|＞)$
    ^【数値】 ?(未満|ミマン)$
    ^(<|＜) ?【数値】$

#### 変換前の例:

    300>
    300 >
    300＞
    300 ＞
    300未満
    300 未満
    300ミマン
    300 ミマン
    <300
    < 300
    ＜300
    ＜ 300

## 4.検出限界以下の値

#### SN型での記載:

    <=^【数値】
    
#### 正規表現:

    ^【数値】 ?(≧|>=|=>|＞＝|＝＞)$
    ^【数値】 ?(以下|イカ)$
    ^(≦|<=|=<|＜＝|＝＜) ?【数値】$
    
#### 変換前の例:

    400≧
    400 ≧
    400>=
    400 >=
    400=>
    400 =>
    400＞＝
    400 ＞＝
    400＝＞
    400 ＝＞
    400以下
    400 以下
    400イカ
    400 イカ
    ≦400
    ≦ 400
    <=400
    <= 400
    =<400
    =< 400
    ＜＝400
    ＜＝ 400
    ＝＜400
    ＝＜ 400
    
## 5.定性結果(-)
#### SN型での記載: 
    ^^-
    
#### 正規表現:

    ^([\-\－]|[\(（][\-\－][\)）])$
    ^(陰性|インセイ)$
    ^(検出せず|検出セズ|ケンシュツセズ|ケンシユツセズ)$
    ^(フケンシュツ|フケンシユツ)$
    ^(ミケンシュツ|ミケンシユツ)$

#### 変換前の例:

    -
    －
    (-)
    （-）
    インセイ
    陰性
    検出せず
    検出セズ
    ケンシュツセズ
    ケンシユツセズ
    フケンシュツ
    フケンシユツ
    ミケンシュツ
    ミケンシユツ
    
## 6.定性結果(+)
#### SN型での記載:
    ^^+
    
#### 正規表現:

    ^([\+\＋]|[\(（][\+\＋][\)）])$
    ^(陽性|ヨウセイ)$
    
#### 変換前の例:

    +
    ＋
    （+）
    (+)
    （＋）
    (＋)
    ヨウセイ
    陽性
    
## 7.定性結果(+-)
#### SN型での記載:
    ^^+-
    
#### 正規表現:

    ^(\+\/?\-|[\(（]\+\/?\-[\)）])$
    ^(±|[\(（]±[\)）])

#### 変換前の例:

    +-
    +/-
    (+-)
    (+/-)
    (+/-）
    ±
    (±)
    （±）
    
## 8.定性結果（半定量）
    ^【1桁の正の整数】^+
    
#### 正規表現:

    ^([1-5１-５][\+＋]|\([1-5１-５][\+＋]\)|（[1-5１-５][\+＋]）)$
    ^(\(\+\+\)|\(＋＋\)|\+\+|＋＋)$
    ^(\(\+\+\+\)|\(＋＋＋\)|\+\+\+|＋＋＋)$
    ^(\(\+\+\+\+\)|\(＋＋＋＋\)|\+\+\+\+|＋＋＋＋)$
    ^(\(\+\+\+\+\+\)|\(＋＋＋＋＋\)|\+\+\+\+\+|＋＋＋＋＋)$
    
#### 変換前の例:

    1+
    (2+)
    ３＋
    （４＋）
    5+
    (++)
    ＋＋＋
    (＋＋＋＋)
    +++++

## 9.範囲
#### SN型での記載:

    ^【数値】^-^【数値】
    
#### 正規表現:

    ^【数値】(\-|～)【数値】$
    
#### 変換前の例:

    1-4
    0.5～2

## 10.比率
#### SN型での記載:
    ^【数値】^:^【数値】
    
#### 条件:

JLAC10が以下の場合に限る

    後日記載

#### 正規表現:

    ^【数値】(:|：)【数値】$

#### 変換前の例:

    後日記載

## 11.分数
#### SN型での記載:

    ^【数値】^/^【数値】

#### 条件:

JLAC10が以下の場合に限る

    1C030000004192001 細胞数[髄液]
    1C03500000419205[1-9] 細胞種類[髄液]
    2A160000001930963 血液像(自動機械法) 赤芽球
    2A160000001931063 血液像(鏡検法) 赤芽球

#### 正規表現:

    ^【数値】(\/|／)【数値】$
    
#### 変換前の例:

    1C030000004192001 細胞数[髄液]... 52/3
    1C035000004192051 細胞種類[髄液] リンパ球... 20/3
    1C035000004192053 細胞種類[髄液] 好中球... 7/3
    2A160000001930963 血液像 赤芽球... 2.0/300
